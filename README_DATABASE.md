# База данных - Использование Vercel Blob

## Проблема с файловой системой на Vercel

На Vercel файловая система доступна только для чтения. При попытке записи возникает ошибка:
```
EROFS: read-only file system, open '/var/task/data/collections/users.json'
```

## Решение

Для решения этой проблемы код использует **Vercel Blob Storage** для хранения JSON файлов базы данных в production.

## Автоматическое переключение

Код автоматически определяет режим работы:
- Если установлена переменная `BLOB_READ_WRITE_TOKEN` → используется Vercel Blob Storage
- Если переменная не установлена → используется файловая система (development)

## Настройка на Vercel

1. Создайте Blob Store в настройках проекта Vercel (Storage → Create Database)
2. Переменная `BLOB_READ_WRITE_TOKEN` будет установлена автоматически
3. При следующем деплое код автоматически начнет использовать Blob Storage

## Важно

⚠️ **Все API routes уже используют async функции**, поэтому они автоматически будут работать с Blob Storage.

⚠️ **Первая запись в коллекцию создаст файл в Blob Storage**. Если файла еще нет, он будет создан автоматически при первом `create()` или `update()`.

## Миграция данных

Если у вас уже есть данные в JSON файлах локально:
1. Они будут использоваться в development режиме
2. В production на Vercel данные нужно будет создать заново через API endpoints
3. Или вы можете использовать seed скрипты для начальной загрузки данных

## Проверка работы

После деплоя на Vercel:
1. Проверьте, что переменная `BLOB_READ_WRITE_TOKEN` установлена
2. Попробуйте создать новый продукт через API
3. Проверьте логи - не должно быть ошибок EROFS

